<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run <code>Rscript</code>, but Bring-Your-Own-Dockerfile (BYOD) • ghactions</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Run &lt;code&gt;Rscript&lt;/code&gt;, but Bring-Your-Own-Dockerfile (BYOD)">
<meta property="og:description" content="">
<meta property="og:image" content="https://r-lib.github.io/ghactions/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ghactions</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ghactions.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../pres/index.html">Presentation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maxheld83/ghactions">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Run <code>Rscript</code>, but Bring-Your-Own-Dockerfile (BYOD)</h1>
                        <h4 class="author">Maximilian Held</h4>
            
            <h4 class="date">2019-08-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/ghactions/blob/master/vignettes/rscript-byod.Rmd"><code>vignettes/rscript-byod.Rmd</code></a></small>
      <div class="hidden name"><code>rscript-byod.Rmd</code></div>

    </div>

    
    
<p>This is a very <strong>simple</strong> GitHub action; it just runs in <code>Rscript</code> whatever you provide as the <code>args</code> field (see below). This action is meant for <strong>generic</strong> R projects with <strong>arbitrary build environments</strong>; you therefore <a href="http://www.maxheld.de/ghactions/articles/ghactions.html#docker"><strong>have to bring your own dockerfile</strong></a>. Such a <code>Dockerfile</code> has to exist at the root of your repository.</p>
<p>Whatever you pass <code>Rscript</code> will simply run <em>in</em> an image build from that <code>Dockerfile</code>. Hence the name: <strong>bring-your-own-dockerfile</strong>.</p>
<p>You can find popular Docker images for R projects at the <a href="https://www.rocker-project.org/">Rocker Project</a>.</p>
<p>You can use the <code><a href="../reference/use_dockerfile.html">ghactions::use_dockerfile()</a></code> function to set up a simple <code>Dockerfile</code> in your repository.</p>
<p>If you’re using this action on your own, remember that <strong>this action expects a built image called <code>repo:latest</code> in your <code>/github/workspace</code>.</strong> Use <code><a href="../reference/docker_cli.html">ghactions::build_image()</a></code> to build such an image from your <code>Dockerfile</code> first.</p>
<p>If this all sounds rather complicated, consider the <a href="http://www.maxheld.de/ghactions/articles/ghactions.html#docker">short documentation</a>.</p>
<div id="environment-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#environment-variables" class="anchor"></a>Environment Variables</h2>
<p>None so far.</p>
</div>
<div id="secrets" class="section level2">
<h2 class="hasAnchor">
<a href="#secrets" class="anchor"></a>Secrets</h2>
<p>nada.</p>
</div>
<div id="required-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#required-arguments" class="anchor"></a>Required Arguments</h2>
<p>Whatever your provide in <code>args</code> simply gets appended to the <code>Rscript</code> call. So just imagine <code>Rscript</code> in front of it; if it is a valid shell command, you’re good to go. Remember that <code>Rscript</code> is the (<a href="https://stackoverflow.com/questions/18306362/run-r-script-from-command-line/18306656#18306656">now preferred</a>) way to run R from a system shell (<em>not</em> the R console). We have to use <code>Rscript</code>, because there’s no GUI that could hook us up directly to the R console in our non-interactive image run. <a href="https://stat.ethz.ch/R-manual/R-devel/library/utils/html/Rscript.html">Here</a> is the full documentation.</p>
<p>A typical <code>args</code> example is</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="st">"-e 'rmarkdown::render_site()'"</span></code></pre></div>
<p>which is appended to <code>Rscript</code> by this action, so you’re really running</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">Rscript</span> -e <span class="st">'rmarkdown::render_site()'</span></code></pre></div>
<p>which <code>Rscript</code> passes to the R console, where you know it as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rmarkdown<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rmarkdown/topics/render_site">render_site</a></span>()</code></pre></div>
</div>
<div id="optional-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#optional-arguments" class="anchor"></a>Optional Arguments</h2>
<p>Nope.</p>
</div>
<div id="example-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example Usage</h2>
<p>Here is a complete <code>main.workflow</code> that first builds your (byod) image, and then runs <code><a href="https://www.rdocumentation.org/packages/rmarkdown/topics/render_site">rmarkdown::render_site()</a></code> on it. You can also get this automatically by running one of the <code><a href="../reference/website.html">ghactions::website()</a></code> function in the ghactions package.</p>
<pre><code>workflow "Build then render" {
  on = "push"
  resolves = "Render rmarkdown"
}

action "Build image" {
  uses = "actions/docker/cli@c08a5fc9e0286844156fefff2c141072048141f6"
  args = "build --tag=repo:latest ."
}

action "Render rmarkdown" {
  needs = "Build image"
  uses = "maxheld83/ghactions/Rscript-byod@master"
  args = "-e 'rmarkdown::render_site()'"
}</code></pre>
<p>Of course, you can also use the visual workflow editor in GitHub, which is highly recommended.</p>
<p>The cryptic-seeming <code>uses = "maxheld83/ghactions/Rscript-byod@master"</code> in the above is simply a way to take a <em>particular</em> version of this action as a dependency. The part after <code>@</code> is a git tag, or release from my (= the action developer’s) repo. It is generally recommended to specify dependencies in GitHub actions as narrowly as you can. That way, your workflow won’t break if the maintainer of the action changes things up.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#environment-variables">Environment Variables</a></li>
      <li><a href="#secrets">Secrets</a></li>
      <li><a href="#required-arguments">Required Arguments</a></li>
      <li><a href="#optional-arguments">Optional Arguments</a></li>
      <li><a href="#example-usage">Example Usage</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.maxheld.de">Max Held</a>, <a href="https://jimhester.com/">Jim Hester</a>, RStudio Inc..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '8f10ced26cbc746213d4922f059ceb49',
    indexName: 'ghactions',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
